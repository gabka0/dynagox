IMPORT DTREE FROM FILE 'dumbbell.txt';

CREATE STREAM R1(A long, B long) FROM FILE 'R1.dat' LINE DELIMITED CSV;
CREATE STREAM R2(B long, C long) FROM FILE 'R2.dat' LINE DELIMITED CSV;
CREATE STREAM R3(C long, A long) FROM FILE 'R3.dat' LINE DELIMITED CSV;
CREATE STREAM R4(C long, D long) FROM FILE 'R4.dat' LINE DELIMITED CSV;
CREATE STREAM R5(D long, E long) FROM FILE 'R5.dat' LINE DELIMITED CSV;
CREATE STREAM R6(E long, G long) FROM FILE 'R6.dat' LINE DELIMITED CSV;
CREATE STREAM R7(G long, D long) FROM FILE 'R7.dat' LINE DELIMITED CSV;

SELECT SUM(1) FROM R1 NATURAL JOIN R2 NATURAL JOIN R3
NATURAL JOIN R4 NATURAL JOIN R5 NATURAL JOIN R6 NATURAL JOIN R7;

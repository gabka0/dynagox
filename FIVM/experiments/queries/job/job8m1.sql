IMPORT DTREE FROM FILE 'job8.txt';

CREATE TYPE RingMax FROM FILE 'ring_max.hpp';

CREATE STREAM AN(A long, B long) FROM FILE 'an.dat' LINE DELIMITED CSV;
CREATE STREAM CI(B long, C long) FROM FILE 'ci.dat' LINE DELIMITED CSV;
CREATE STREAM MC(D long, C long) FROM FILE 'mc.dat' LINE DELIMITED CSV;

SELECT SUM([lift: RingMax](A) * [lift: RingMax](D)) FROM AN NATURAL JOIN CI NATURAL JOIN MC;
